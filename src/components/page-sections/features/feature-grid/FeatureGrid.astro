---
import CustomSection from "@builders/custom-section/CustomSection.astro";
import Heading from "@core-elements/heading/Heading.astro";
import SimpleText from "@core-elements/simple-text/SimpleText.astro";
import Text from "@core-elements/text/Text.astro";
import FeatureItem from "@features/feature-grid/FeatureItem.astro";
import ButtonGroup from "@wrappers/button-group/ButtonGroup.astro";
import Grid from "@wrappers/grid/Grid.astro";
import GridItem from "@wrappers/grid/GridItem.astro";

const {
  eyebrow = "",
  heading = "",
  subtext = "",
  features = [],
  colorScheme,
  backgroundColor,
  paddingVertical = "4xl",
  class: className,
  buttonSections = [],
} = Astro.props;
---

<CustomSection
  class:list={["feature-grid", className]}
  maxContentWidth="2xl"
  paddingHorizontal="lg"
  paddingVertical={paddingVertical}
  colorScheme={colorScheme}
  backgroundColor={backgroundColor}
>
  {
    eyebrow && (
      <SimpleText alignX="center" class="eyebrow" data-prop="eyebrow">
        {eyebrow}
      </SimpleText>
    )
  }
  {
    heading && (
      <Heading level="h2" size="lg" alignX="center" data-prop="heading">
        {heading}
      </Heading>
    )
  }
  {
    subtext && (
      <Text class="feature-grid-subtext" alignX="center" data-prop="subtext" text={subtext} />
    )
  }
  {
    features?.length > 0 && (
      <Grid
        gap="lg"
        minItemWidth="320"
        maxItemWidth="360"
        style="margin-top: var(--spacing-2xl)"
        data-prop="features"
        class="feature-grid-items"
      >
        {features.map((feature, index) => (
          <GridItem>
            <editable-array-item data-component="page-sections/features/feature-grid/feature-item">
              <FeatureItem {...feature} class="feature-grid-item" data-index={index} />
            </editable-array-item>
          </GridItem>
        ))}
      </Grid>
    )
  }

  {
    buttonSections?.length > 0 && (
      <ButtonGroup
        class="feature-grid-buttons"
        buttonSections={buttonSections}
        direction="row"
        alignX="center"
      />
    )
  }
</CustomSection>

<style lang="pcss">
  .feature-grid-items {
    @container (max-width: 1020px) {
      > :global(editable-array-item),
      > :global(.grid-item) {
        flex-basis: 100% !important;
        max-width: 100% !important;
      }
    }
  }

  .feature-grid-buttons {
    margin-top: var(--spacing-3xl);
  }
</style>
